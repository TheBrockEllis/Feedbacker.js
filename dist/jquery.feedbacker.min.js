/*
 *  Feedbacker - v0.1.0
 *  A lean plugin that enables instant feedback on any page
 *  http://github.io/TheBrockEllis/Feedbacker.js
 *
 *  Made by Brock Ellis
 *  Under MIT License
 */
!function(a,b,c){function d(b,c){this.element=b,this.settings=a.extend({},f,c),this._defaults=f,this._name=e,this.init()}var e="feedbacker",f={width:50,height:50,name:!0,requireName:!0,email:!0,requireEmail:!0,message:!0,requireMessage:!0,action:"http://www.yourdomain.com/feedbacker.php",acknowledgement:"Thank you for your feedback!"};a.extend(d.prototype,{init:function(){var b=c.createElement("div");a(b).addClass("questionMark").css({width:this.settings.width+"px",height:this.settings.height+"px","line-height":this.settings.height+"px",bottom:"5px",right:"5px"}).text("?"),a(this.element).append(b);var d=c.createElement("div"),e=this.settings.height+25;a(d).addClass("feedbackModal").css({bottom:e+"px",right:"5px"});var f=c.createElement("form");if(f.id="feedbackerForm",f.action=this.settings.action,f.method="post",a(d).append(f),this.settings.name===!0){var g=c.createElement("input");g.type="text",g.placeholder="Name",g.id="name",g.className="formElement",a(f).append(g)}if(this.settings.email===!0){var h=c.createElement("input");h.type="text",h.placeholder="Email",h.id="email",h.className="formElement",a(f).append(h)}if(this.settings.message===!0){var i=c.createElement("textarea");i.value="Message",i.id="message",i.className="formElement formMessage",a(f).append(i)}var j=c.createElement("input");j.type="submit",j.value="Submit",j.id="feedbackerSubmit",j.className="formElement formButton",a(f).append(j),a(this.element).append(d),a(b).on("click",function(){a(d).toggle(),a(this).toggleClass("questionMarkActive")}),a("#message").on("click focus",function(){"Message"===a(this).val()&&a(this).val("")}),a("input, textarea").attr("autocomplete","off"),a(f).submit(a.proxy(this.submitForm,this))},submitForm:function(b){b.preventDefault();var c=this,d=c.settings.acknowledgement;return c.settings.requireEmail&&""===a("#email").val()?void alert("Please enter your email address"):c.settings.requireName&&""===a("#name").val()?void alert("Please enter your name"):c.settings.requireMessage&&"Message"===a("#message").val()?void alert("Please enter a message"):void a.ajax({url:this.settings.action,data:a("#feedbackerForm").serialize(),type:"post",contentType:"application/json"}).done(function(){a.proxy(c.showResult(d),this)}).fail(function(){a.proxy(c.showResult("Uh oh. The feedbackzzzzzz was not submitted successfully. Try again later?"),this)}).always(function(){a("#feedbackerForm").find("input[type=text], textarea").val(""),setTimeout(function(){var b=a(".feedbackModal");b.hide(),b.find("form").show(),b.find("h1").remove(),a(".questionMark").removeClass("questionMarkActive")},3e3)})},showResult:function(b){var c=a(".feedbackModal");c.find("form").css("display","none"),c.append("<h1>"+b+"</h1>")}}),a.fn[e]=function(b){return this.each(function(){a.data(this,"plugin_"+e)||a.data(this,"plugin_"+e,new d(this,b))}),this}}(jQuery,window,document);